# Generated by Claude.
# Makefile for collections migration CLI

.PHONY: build clean run dry-run

# Build the migration CLI
build:
	go build -o bin/migrate .

# Clean build artifacts
clean:
	rm -f migrate

# Run migration (requires TABLE environment variable)
run: build
	@if [ -z "$(TABLE)" ]; then \
		echo "Error: TABLE is required. Usage: make run TABLE=alexandria"; \
		exit 1; \
	fi
	./migrate --table=$(TABLE) --region=$(or $(REGION),eu-central-1)

# Run migration in dry-run mode
dry-run: build
	@if [ -z "$(TABLE)" ]; then \
		echo "Error: TABLE is required. Usage: make dry-run TABLE=alexandria"; \
		exit 1; \
	fi
	./migrate --table=$(TABLE) --region=$(or $(REGION),eu-central-1) --dry-run

# Install dependencies
deps:
	go mod tidy
